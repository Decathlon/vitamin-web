<div class="block">
  <div id="dropdown-demo" class="vtmn-dropdown">
    <label id="dropdown-demo-label">Favorite Sports</label>
    <details id="dropdown-details">
      <summary aria-labelledby="dropdown-demo-label">
        Choose your favorite sports
      </summary>
      <div
        id="dropdown-items"
        class="vtmn-dropdown_items"
        style="height: 200px"
        role="group"
        aria-labelledby="dropdown-demo-label"
      >
        <span id="block-focus-trap-start" tabindex="-1"></span>

        <input type="checkbox" name="dropdown-demo" id="dropdown-demo-opt-1" />
        <label for="dropdown-demo-opt-1">
          <span class="vtmx-emotion-laugh-line"></span>
          Gymnastics
        </label>

        <div
          class="vtmn-divider vtmn-divider_orientation--horizontal"
          role="separator"
        ></div>

        <input type="checkbox" name="dropdown-demo" id="dropdown-demo-opt-2" />
        <label for="dropdown-demo-opt-2">
          <span class="vtmx-arrow-right-line"></span>
          Archery
        </label>

        <div
          class="vtmn-divider vtmn-divider_orientation--horizontal"
          role="separator"
        ></div>

        <input type="checkbox" name="dropdown-demo" id="dropdown-demo-opt-3" />
        <label for="dropdown-demo-opt-3">
          <span class="vtmx-football-line"></span>
          Football
        </label>

        <div
          class="vtmn-divider vtmn-divider_orientation--horizontal"
          role="separator"
        ></div>

        <input type="checkbox" name="dropdown-demo" id="dropdown-demo-opt-4" />
        <label for="dropdown-demo-opt-4">
          <span class="vtmx-riding-line"></span>
          Cycling
        </label>

        <div
          class="vtmn-divider vtmn-divider_orientation--horizontal"
          role="separator"
        ></div>

        <input type="checkbox" name="dropdown-demo" id="dropdown-demo-opt-5" />
        <label for="dropdown-demo-opt-5">
          <span class="vtmx-showers-line"></span>
          Swimming
        </label>

        <div
          class="vtmn-divider vtmn-divider_orientation--horizontal"
          role="separator"
        ></div>

        <input type="checkbox" name="dropdown-demo" id="dropdown-demo-opt-6" />
        <label for="dropdown-demo-opt-6">
          <span class="vtmx-walk-line"></span>
          Hiking
        </label>

        <div
          class="vtmn-divider vtmn-divider_orientation--horizontal"
          role="separator"
        ></div>

        <span id="block-focus-trap-end" tabindex="0"></span>
      </div>
    </details>
  </div>
</div>

<script>
  let firstItem = document.querySelector('#dropdown-demo-opt-1');
  let lastItem = document.querySelector('#dropdown-demo-opt-6');

  let groupItem = document.querySelector('#dropdown-items');

  let firstFocusTrap = document.querySelector('#block-focus-trap-start');
  let lastFocusTrap = document.querySelector('#block-focus-trap-end');

  groupItem.addEventListener('focus', () => {
    firstItem.focus();
  });

  groupItem.addEventListener('focusout', () => {
    firstFocusTrap.setAttribute('tabindex', '-1');
  });

  groupItem.addEventListener('keydown', function (e) {
    if (e.key === 'Escape') {
      document.querySelector('#dropdown-details').open = false;
      document.querySelector('#dropdown-details > summary').focus();
    }
  });

  firstItem.addEventListener('focus', () => {
    firstFocusTrap.setAttribute('tabindex', '0');
  });

  firstFocusTrap.addEventListener('focus', () => {
    lastItem.focus();
  });

  lastFocusTrap.addEventListener('focus', () => {
    firstItem.focus();
  });
</script>
